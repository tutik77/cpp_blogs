## Блог-платформа (C++) — Техническое задание (ТЗ)

### 1. Цель и краткое описание
Блог-платформа — это веб‑сервис, где пользователи публикуют посты (текст, фото, видео) в своем профиле, взаимодействуют через лайки и комментарии, а также подписки. Доступ к защищенным операциям выполняется по JWT.

### 2. Роли
- **Гость**: просмотр публичных профилей и постов.
- **Пользователь**: регистрация/вход, управление своим профилем, создание/редактирование/удаление своих постов, загрузка вложений (фото/видео), комментирование, лайки, подписки.
- **Администратор (опционально)**: модерация контента и пользователей.

### 3. Основные сущности (классы домена)
- **User**
  - Поля: `id`, `username`, `email`, `passwordHash`, `createdAt`, `profile`, `followersUserIds`, `followingUserIds`.
  - Контейнеры STL: `std::map<Id, User>`, `std::vector<Id>`.
  - Операции: регистрация, авторизация (через `AuthService`), изменение профиля, подписка/отписка.
- **Profile**
  - Поля: `userId`, `displayName`, `bio`, `avatarPath`.
  - Хранится как часть `User`.
- **Post**
  - Поля: `id`, `authorId`, `text`, `attachments`, `createdAt`, `updatedAt`, `visibility` (public/private), `likedUserIds`.
  - Контейнеры: `std::vector<Attachment>`, `std::vector<Id>`.
- **Attachment**
  - Поля: `id`, `postId`, `type` (photo|video), `filePath`, `meta` (размер, длительность и т.д. — опционально).
- **Comment**
  - Поля: `id`, `postId`, `authorId`, `text`, `createdAt`.
  - Контейнеры: `std::map<Id, Comment>`, индексы по `postId`.

Служебные классы (менеджеры/сервисы):
- **AuthService**: верификация/генерация JWT, проверка прав.
- **UserManager**: CRUD пользователей/профилей, подписки.
- **PostManager**: CRUD постов и вложений, лайки.
- **CommentManager**: CRUD комментариев.
- **FeedService**: лента (агрегация постов подписок, сортировка).
- **StorageRepository**: файловое хранение/загрузка доменных сущностей.
- **ValidationService**: валидация входных данных.

Минимально для соответствия ООП: `User`, `Post`, `PostManager` (остальные — желательно).

### 4. Функциональные требования (операции)
- **Аутентификация/авторизация**
  - Регистрация пользователя.
  - Вход (получение JWT), обновление токена (refresh), выход (инвалидция — опционально).
- **Профиль**
  - Просмотр профиля (своего/чужого — публичная часть).
  - Редактирование профиля (имя, био, аватар).
- **Посты**
  - Создание поста (текст, вложения: фото/видео).
  - Редактирование/удаление своего поста.
  - Просмотр поста по `id`, список постов пользователя.
  - Поиск/фильтрация постов (по автору, ключевым словам, периоду).
- **Взаимодействия**
  - Лайк/анлайк поста.
  - Добавление/удаление комментария, список комментариев поста.
- **Подписки и лента**
  - Подписка/отписка на пользователя.
  - Лента: посты от подписок, отсортированные по дате (с пагинацией).
- **Медиа**
  - Загрузка файлов (сохранение в каталог, индексация в файле метаданных).
  - Ограничения по размеру/формату, базовая валидация.

### 5. REST API (черновик интерфейсов)
- `POST /auth/register` — регистрация.
- `POST /auth/login` — вход, получение JWT.
- `POST /auth/refresh` — обновление токена.
- `GET /users/{id}` — профиль пользователя.
- `PUT /users/me` — обновление своего профиля.
- `POST /users/{id}/follow` / `DELETE /users/{id}/follow` — подписка/отписка.
- `GET /posts/{id}` — получить пост.
- `GET /users/{id}/posts` — список постов пользователя.
- `POST /posts` — создать пост (текст + загрузка вложений).
- `PUT /posts/{id}` — обновить свой пост.
- `DELETE /posts/{id}` — удалить свой пост.
- `POST /posts/{id}/like` / `DELETE /posts/{id}/like` — лайк/анлайк.
- `GET /posts/{id}/comments` — список комментариев.
- `POST /posts/{id}/comments` — добавить комментарий.
- `DELETE /comments/{id}` — удалить свой комментарий.
- `GET /feed` — получить ленту (подписки, пагинация: `?offset=&limit=`).

Все защищенные операции требуют заголовка `Authorization: Bearer <JWT>`.